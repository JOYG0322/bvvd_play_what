<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>战争雷霆模式抽取工具</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            /* 白天主题变量 */
            --day-bg-color: #f0f4f8;
            --day-container-bg: #ffffff;
            --day-text-color: #2c3e50;
            --day-primary-color: #3498db;
            --day-secondary-color: #2c3e50;
            --day-border-color: #dbe2e8;
            --day-button-bg: #3498db;
            --day-button-text: #ffffff;
            --day-result-bg: #e8f4fc;
            --day-history-bg: #f8f9fa;
            --day-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --day-mode-bg: #e8f4fc;
            
            /* 黑夜主题变量 */
            --night-bg-color: #1a2a1a;
            --night-container-bg: #213421;
            --night-text-color: #e0e0c0;
            --night-primary-color: #c8b070;
            --night-secondary-color: #e0e0c0;
            --night-border-color: #5a7d5a;
            --night-button-bg: #5a7d5a;
            --night-button-text: #e0e0c0;
            --night-result-bg: #2a3c2a;
            --night-history-bg: #223322;
            --night-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
            --night-mode-bg: #2a3c2a;
            
            /* 当前主题变量（默认白天） */
            --bg-color: var(--day-bg-color);
            --container-bg: var(--day-container-bg);
            --text-color: var(--day-text-color);
            --primary-color: var(--day-primary-color);
            --secondary-color: var(--day-secondary-color);
            --border-color: var(--day-border-color);
            --button-bg: var(--day-button-bg);
            --button-text: var(--day-button-text);
            --result-bg: var(--day-result-bg);
            --history-bg: var(--day-history-bg);
            --shadow: var(--day-shadow);
            --mode-bg: var(--day-mode-bg);
        }

        body.night-theme {
            --bg-color: var(--night-bg-color);
            --container-bg: var(--night-container-bg);
            --text-color: var(--night-text-color);
            --primary-color: var(--night-primary-color);
            --secondary-color: var(--night-secondary-color);
            --border-color: var(--night-border-color);
            --button-bg: var(--night-button-bg);
            --button-text: var(--night-button-text);
            --result-bg: var(--night-result-bg);
            --history-bg: var(--night-history-bg);
            --shadow: var(--night-shadow);
            --mode-bg: var(--night-mode-bg);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: background-color 0.3s, color 0.3s, border-color 0.3s;
        }
        
        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            padding: 15px;
            line-height: 1.6;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
            -webkit-tap-highlight-color: transparent;
        }
        
        .container {
            max-width: 100%;
            margin: 0 auto;
            padding: 10px;
        }
        
        header {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
            padding: 15px;
            background: var(--container-bg);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow);
        }
        
        .header-title {
            text-align: center;
        }
        
        .header-controls {
            display: flex;
            gap: 10px;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .theme-toggle, .lang-select {
            padding: 12px 15px;
            background: var(--button-bg);
            color: var(--button-text);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            flex: 1;
            min-width: 140px;
            text-align: center;
            font-size: 16px;
        }
        
        .lang-select {
            background: var(--container-bg);
            border: 1px solid var(--border-color);
            color: var(--text-color);
            padding: 12px 10px;
        }
        
        h1 {
            color: var(--primary-color);
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
            font-size: 1.8rem;
            margin-bottom: 5px;
        }
        
        .main-content {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .modes-section, .result-section {
            width: 100%;
            background: var(--container-bg);
            padding: 20px 15px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow);
        }
        
        .section-title {
            color: var(--primary-color);
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--border-color);
            text-align: center;
            font-size: 1.4rem;
        }
        
        .mode-item {
            margin-bottom: 12px;
            padding: 12px 15px;
            background: var(--mode-bg);
            border-radius: 10px;
            border: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            transition: all 0.3s ease;
        }
        
        .mode-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .mode-item input {
            margin-right: 15px;
            transform: scale(1.4);
            accent-color: var(--primary-color);
        }
        
        .mode-item label {
            font-size: 1.1rem;
            color: var(--text-color);
            cursor: pointer;
            flex: 1;
            padding: 5px 0;
        }
        
        .buttons {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 20px;
        }
        
        button {
            padding: 16px;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--button-bg);
            color: var(--button-text);
            min-height: 55px;
        }
        
        button:active {
            transform: scale(0.98);
        }
        
        #draw-button {
            background: var(--primary-color);
            color: var(--container-bg);
            font-size: 1.2rem;
            margin-top: 10px;
        }
        
        .result-display {
            text-align: center;
            padding: 25px 15px;
            margin: 15px 0;
            background: var(--result-bg);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            min-height: 180px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        
        .result-text {
            font-size: 1.8rem;
            color: var(--primary-color);
            margin: 10px 0;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
            word-break: break-word;
            line-height: 1.3;
        }
        
        .result-time {
            color: var(--secondary-color);
            font-size: 0.95rem;
            margin-top: 12px;
        }
        
        .history-section {
            background: var(--container-bg);
            padding: 20px 15px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow);
            margin-bottom: 20px;
        }
        
        .history-list {
            max-height: 250px;
            overflow-y: auto;
            padding: 10px;
            background: var(--history-bg);
            border-radius: 10px;
            border: 1px solid var(--border-color);
        }
        
        .history-item {
            padding: 12px 10px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.95rem;
        }
        
        .history-item:last-child {
            border-bottom: none;
        }
        
        .history-mode {
            font-weight: bold;
            color: var(--primary-color);
            flex: 1;
        }
        
        .history-time {
            color: var(--secondary-color);
            font-size: 0.85rem;
            text-align: right;
            margin-left: 10px;
        }
        
        footer {
            text-align: center;
            margin-top: 30px;
            color: var(--secondary-color);
            font-size: 0.85rem;
            padding: 0 10px;
        }
        
        /* 移动设备优化 */
        @media (max-width: 480px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 5px;
            }
            
            header {
                padding: 15px 10px;
            }
            
            h1 {
                font-size: 1.6rem;
            }
            
            .theme-toggle, .lang-select {
                min-width: 120px;
                font-size: 15px;
                padding: 10px 8px;
            }
            
            .modes-section, .result-section, .history-section {
                padding: 15px 10px;
            }
            
            .mode-item {
                padding: 10px 12px;
            }
            
            .mode-item label {
                font-size: 1rem;
            }
            
            .result-text {
                font-size: 1.6rem;
            }
            
            button {
                padding: 14px;
                font-size: 1rem;
                min-height: 50px;
            }
            
            #draw-button {
                font-size: 1.1rem;
            }
            
            .history-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 5px;
            }
            
            .history-time {
                margin-left: 0;
                align-self: flex-end;
            }
        }
        
        @media (min-width: 768px) {
            .container {
                max-width: 90%;
            }
            
            .main-content {
                flex-direction: row;
            }
            
            .modes-section, .result-section {
                flex: 1;
            }
            
            .buttons {
                flex-direction: row;
            }
            
            header {
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
            }
            
            .header-title {
                text-align: left;
                flex: 1;
            }
            
            .header-controls {
                flex-wrap: nowrap;
                justify-content: flex-end;
            }
        }
        
        @media (min-width: 1024px) {
            .container {
                max-width: 1000px;
            }
        }
    </style>
</head>
<body class="light-theme">
    <div class="container">
        <header>
            <div class="header-title">
                <h1 id="title">战争雷霆模式抽取工具</h1>
            </div>
            <div class="header-controls">
                <button class="theme-toggle" id="theme-toggle">🌙 切换到黑夜模式</button>
                <select class="lang-select" id="lang-select">
                    <option value="zh">中文</option>
                    <option value="en">English</option>
                    <option value="ru">Русский</option>
                </select>
            </div>
        </header>
        
        <div class="main-content">
            <div class="modes-section">
                <h2 class="section-title" id="select-title">选择模式</h2>
                <div class="mode-item">
                    <input type="checkbox" id="ground-ab" checked>
                    <label for="ground-ab" id="label-ground-ab">陆战街机</label>
                </div>
                <div class="mode-item">
                    <input type="checkbox" id="ground-rb" checked>
                    <label for="ground-rb" id="label-ground-rb">陆战历史</label>
                </div>
                <div class="mode-item">
                    <input type="checkbox" id="ground-sb">
                    <label for="ground-sb" id="label-ground-sb">陆战全真</label>
                </div>
                <div class="mode-item">
                    <input type="checkbox" id="air-ab" checked>
                    <label for="air-ab" id="label-air-ab">空战街机</label>
                </div>
                <div class="mode-item">
                    <input type="checkbox" id="air-rb" checked>
                    <label for="air-rb" id="label-air-rb">空战历史</label>
                </div>
                
                <div class="buttons">
                    <button id="select-all">全选</button>
                    <button id="select-none">全不选</button>
                </div>
                <div class="buttons">
                    <button id="draw-button">抽取模式</button>
                </div>
            </div>
            
            <div class="result-section">
                <h2 class="section-title" id="result-title">抽取结果</h2>
                <div class="result-display">
                    <p id="click-to-draw">点击抽取按钮开始</p>
                    <div class="result-text" id="result">-</div>
                    <div class="result-time" id="result-time"></div>
                </div>
            </div>
        </div>
        
        <div class="history-section">
            <h2 class="section-title" id="history-title">抽取历史</h2>
            <div class="history-list" id="history-list">
                <!-- 历史记录将在这里显示 -->
            </div>
        </div>
        
        <footer>
            <p id="footer-text">战争雷霆模式抽取工具 | 部署于 Cloudflare Workers | 数据存储在本地浏览器中</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 语言配置
            const translations = {
                'zh': {
                    'title': '战争雷霆模式抽取工具',
                    'select-title': '选择模式',
                    'label-ground-ab': '陆战街机',
                    'label-ground-rb': '陆战历史',
                    'label-ground-sb': '陆战全真',
                    'label-air-ab': '空战街机',
                    'label-air-rb': '空战历史',
                    'select-all': '全选',
                    'select-none': '全不选',
                    'draw-button': '抽取模式',
                    'result-title': '抽取结果',
                    'click-to-draw': '点击抽取按钮开始',
                    'history-title': '抽取历史',
                    'footer-text': '战争雷霆模式抽取工具 | 部署于 Cloudflare Workers | 数据存储在本地浏览器中',
                    'theme-day': '☀️ 切换到白天模式',
                    'theme-night': '🌙 切换到黑夜模式',
                    'no-history': '暂无历史记录',
                    'no-selection': '请至少选择一个模式'
                },
                'en': {
                    'title': 'War Thunder Mode Selector',
                    'select-title': 'Select Modes',
                    'label-ground-ab': 'Ground AB',
                    'label-ground-rb': 'Ground RB',
                    'label-ground-sb': 'Ground SB',
                    'label-air-ab': 'Air AB',
                    'label-air-rb': 'Air RB',
                    'select-all': 'Select All',
                    'select-none': 'Select None',
                    'draw-button': 'Draw Mode',
                    'result-title': 'Result',
                    'click-to-draw': 'Click draw button to start',
                    'history-title': 'Draw History',
                    'footer-text': 'War Thunder Mode Selector | Deployed on Cloudflare Workers | Data stored locally',
                    'theme-day': '☀️ Switch to Day Mode',
                    'theme-night': '🌙 Switch to Night Mode',
                    'no-history': 'No history yet',
                    'no-selection': 'Please select at least one mode'
                },
                'ru': {
                    'title': 'Выбор режима War Thunder',
                    'select-title': 'Выбор режимов',
                    'label-ground-ab': 'Наземные AB',
                    'label-ground-rb': 'Наземные RB',
                    'label-ground-sb': 'Наземные SB',
                    'label-air-ab': 'Авиационные AB',
                    'label-air-rb': 'Авиационные RB',
                    'select-all': 'Выбрать все',
                    'select-none': 'Снять все',
                    'draw-button': 'Выбрать режим',
                    'result-title': 'Результат',
                    'click-to-draw': 'Нажмите кнопку для выбора',
                    'history-title': 'История выборов',
                    'footer-text': 'Выбор режима War Thunder | Размещено на Cloudflare Workers | Данные хранятся локально',
                    'theme-day': '☀️ Переключить на дневной режим',
                    'theme-night': '🌙 Переключить на ночной режим',
                    'no-history': 'История пуста',
                    'no-selection': 'Пожалуйста, выберите хотя бы один режим'
                }
            };
            
            // 模式数据
            const modes = {
                'ground-ab': {
                    'zh': '陆战街机',
                    'en': 'Ground AB',
                    'ru': 'Наземные AB'
                },
                'ground-rb': {
                    'zh': '陆战历史',
                    'en': 'Ground RB',
                    'ru': 'Наземные RB'
                },
                'ground-sb': {
                    'zh': '陆战全真',
                    'en': 'Ground SB',
                    'ru': 'Наземные SB'
                },
                'air-ab': {
                    'zh': '空战街机',
                    'en': 'Air AB',
                    'ru': 'Авиационные AB'
                },
                'air-rb': {
                    'zh': '空战历史',
                    'en': 'Air RB',
                    'ru': 'Авиационные RB'
                }
            };
            
            // 获取DOM元素
            const themeToggle = document.getElementById('theme-toggle');
            const langSelect = document.getElementById('lang-select');
            const drawButton = document.getElementById('draw-button');
            const resultElement = document.getElementById('result');
            const resultTimeElement = document.getElementById('result-time');
            const historyListElement = document.getElementById('history-list');
            const selectAllButton = document.getElementById('select-all');
            const selectNoneButton = document.getElementById('select-none');
            
            // 初始化设置
            let currentTheme = localStorage.getItem('theme') || 'light';
            let currentLang = localStorage.getItem('language') || 'zh';
            let drawHistory = JSON.parse(localStorage.getItem('warThunderDrawHistory')) || [];
            
            // 应用保存的设置
            applyTheme(currentTheme);
            applyLanguage(currentLang);
            langSelect.value = currentLang;
            updateHistoryDisplay();
            
            // 主题切换事件
            themeToggle.addEventListener('click', function() {
                currentTheme = currentTheme === 'light' ? 'night' : 'light';
                applyTheme(currentTheme);
                localStorage.setItem('theme', currentTheme);
            });
            
            // 语言切换事件
            langSelect.addEventListener('change', function() {
                currentLang = langSelect.value;
                applyLanguage(currentLang);
                localStorage.setItem('language', currentLang);
                updateHistoryDisplay();
            });
            
            // 应用主题
            function applyTheme(theme) {
                if (theme === 'night') {
                    document.body.classList.add('night-theme');
                    themeToggle.textContent = translations[currentLang]['theme-day'];
                } else {
                    document.body.classList.remove('night-theme');
                    themeToggle.textContent = translations[currentLang]['theme-night'];
                }
            }
            
            // 应用语言
            function applyLanguage(lang) {
                // 更新界面文本
                document.getElementById('title').textContent = translations[lang]['title'];
                document.getElementById('select-title').textContent = translations[lang]['select-title'];
                document.getElementById('label-ground-ab').textContent = translations[lang]['label-ground-ab'];
                document.getElementById('label-ground-rb').textContent = translations[lang]['label-ground-rb'];
                document.getElementById('label-ground-sb').textContent = translations[lang]['label-ground-sb'];
                document.getElementById('label-air-ab').textContent = translations[lang]['label-air-ab'];
                document.getElementById('label-air-rb').textContent = translations[lang]['label-air-rb'];
                document.getElementById('select-all').textContent = translations[lang]['select-all'];
                document.getElementById('select-none').textContent = translations[lang]['select-none'];
                document.getElementById('draw-button').textContent = translations[lang]['draw-button'];
                document.getElementById('result-title').textContent = translations[lang]['result-title'];
                document.getElementById('click-to-draw').textContent = translations[lang]['click-to-draw'];
                document.getElementById('history-title').textContent = translations[lang]['history-title'];
                document.getElementById('footer-text').textContent = translations[lang]['footer-text'];
                
                // 更新主题按钮文本
                themeToggle.textContent = currentTheme === 'light' ? 
                    translations[lang]['theme-night'] : translations[lang]['theme-day'];
                
                // 更新结果和历史记录
                if (resultElement.textContent !== '-' && resultElement.textContent !== translations[lang]['no-selection']) {
                    const currentModeId = findModeIdByText(resultElement.textContent, currentLang);
                    if (currentModeId) {
                        resultElement.textContent = modes[currentModeId][lang];
                    }
                }
            }
            
            // 通过文本查找模式ID
            function findModeIdByText(text, lang) {
                for (const id in modes) {
                    if (modes[id][lang] === text) {
                        return id;
                    }
                }
                return null;
            }
            
            // 抽取按钮事件
            drawButton.addEventListener('click', function() {
                // 获取选中的模式
                const selectedModes = [];
                for (const id in modes) {
                    const checkbox = document.getElementById(id);
                    if (checkbox.checked) {
                        selectedModes.push(id);
                    }
                }
                
                // 如果没有选择任何模式，提示用户
                if (selectedModes.length === 0) {
                    resultElement.textContent = translations[currentLang]['no-selection'];
                    resultTimeElement.textContent = '';
                    return;
                }
                
                // 随机选择一个模式
                const randomIndex = Math.floor(Math.random() * selectedModes.length);
                const selectedModeId = selectedModes[randomIndex];
                const selectedModeName = modes[selectedModeId][currentLang];
                
                // 显示结果
                resultElement.textContent = selectedModeName;
                
                // 记录时间
                const now = new Date();
                const timeString = now.toLocaleDateString() + ' ' + now.toLocaleTimeString();
                resultTimeElement.textContent = translations[currentLang]['result-title'] + ': ' + timeString;
                
                // 保存到历史记录
                const historyItem = {
                    mode: selectedModeId,
                    time: timeString,
                    timestamp: now.getTime(),
                    lang: currentLang
                };
                
                drawHistory.unshift(historyItem);
                // 只保留最近20条记录
                if (drawHistory.length > 20) {
                    drawHistory = drawHistory.slice(0, 20);
                }
                
                // 保存到localStorage
                localStorage.setItem('warThunderDrawHistory', JSON.stringify(drawHistory));
                
                // 更新历史记录显示
                updateHistoryDisplay();
            });
            
            // 全选按钮事件
            selectAllButton.addEventListener('click', function() {
                for (const id in modes) {
                    document.getElementById(id).checked = true;
                }
            });
            
            // 全不选按钮事件
            selectNoneButton.addEventListener('click', function() {
                for (const id in modes) {
                    document.getElementById(id).checked = false;
                }
            });
            
            // 更新历史记录显示
            function updateHistoryDisplay() {
                historyListElement.innerHTML = '';
                
                if (drawHistory.length === 0) {
                    historyListElement.innerHTML = `<div class="history-item">${translations[currentLang]['no-history']}</div>`;
                    return;
                }
                
                drawHistory.forEach(item => {
                    const historyItem = document.createElement('div');
                    historyItem.className = 'history-item';
                    
                    const modeName = modes[item.mode] ? modes[item.mode][currentLang] : item.mode;
                    
                    historyItem.innerHTML = `
                        <span class="history-mode">${modeName}</span>
                        <span class="history-time">${item.time}</span>
                    `;
                    historyListElement.appendChild(historyItem);
                });
            }
        });
    </script>
</body>
</html>